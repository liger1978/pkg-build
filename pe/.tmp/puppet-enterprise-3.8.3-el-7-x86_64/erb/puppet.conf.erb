<%# Answer Variable => Ruby Variable Translation -%>
<%
  @agent_server      = ENV["q_puppetagent_server"]
  @agent_certname    = ENV["q_puppetagent_certname"]
  @platform_name     = ENV["PLATFORM_NAME"]
  @puppet_group      = ENV["PLATFORM_PUPPET_GROUP"]
  @puppet_user       = ENV["PLATFORM_PUPPET_USER"]
  @agent_environment = ENV["q_agent_environment"]
-%>
[main]
    certname = <%= @agent_certname %>
<% if @platform_name =~ /aix/i -%>
    vardir = /opt/freeware/var/lib/pe-puppet
    logdir = /opt/freeware/var/log/pe-puppet
    rundir = /opt/freeware/var/run/pe-puppet
<% else -%>
    vardir = /var/opt/lib/pe-puppet
    logdir = /var/log/pe-puppet
    rundir = /var/run/pe-puppet
<% end -%>
    basemodulepath = /etc/puppetlabs/puppet/modules:/opt/puppet/share/puppet/modules
    environmentpath = /etc/puppetlabs/puppet/environments
    server = <%= @agent_server %>
    user  = <%= @puppet_user %>
    group = <%= @puppet_group %>
    archive_files = true
    archive_file_server = <%= @agent_server %>

[agent]
    report = true
    classfile = $vardir/classes.txt
    localconfig = $vardir/localconfig
    graph = true
    pluginsync = true
    <% if @agent_environment -%>
    environment = <%= @agent_environment %>
    <% end -%>
